2021-09-10 00:00:05.025 +01:00 [INF] Host starting.
2021-09-10 00:00:06.269 +01:00 [ERR] An error occured during migration
Autofac.Core.Registration.ComponentNotRegisteredException: The requested service 'CI.interview.pltosman.DataAccess.Concrete.EntityFramework.Contexts.InterviewContext' has not been registered. To avoid this exception, either register a component to provide the service, check for service registration using IsRegistered(), or use the ResolveOptional() method to resolve an optional dependency.
   at Autofac.ResolutionExtensions.ResolveService(IComponentContext context, Service service, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType)
   at Autofac.Extensions.DependencyInjection.AutofacServiceProvider.GetRequiredService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CI.interview.pltosman.api.Program.Main(String[] args) in /Users/osmanpolat/Projects/Interviews/CapitalIndex/CI.interview.pltosman/CI.interview.pltosman.api/Program.cs:line 49
2021-09-10 00:00:06.618 +01:00 [INF] Now listening on: http://localhost:5003
2021-09-10 00:00:06.619 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2021-09-10 00:00:06.619 +01:00 [INF] Hosting environment: Development
2021-09-10 00:00:06.619 +01:00 [INF] Content root path: /Users/osmanpolat/Projects/Interviews/CapitalIndex/CI.interview.pltosman/CI.interview.pltosman.api
2021-09-10 00:00:10.409 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5003/api/Home/readExcelData - 0
2021-09-10 00:00:10.462 +01:00 [INF] CORS policy execution failed.
2021-09-10 00:00:10.465 +01:00 [INF] Request origin http://localhost:5003 does not have permission to access the resource.
2021-09-10 00:00:10.466 +01:00 [INF] Executing endpoint 'CI.interview.pltosman.api.Controllers.HomeController.ReadExcelData (CI.interview.pltosman.api)'
2021-09-10 00:00:10.482 +01:00 [INF] Route matched with {action = "ReadExcelData", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult ReadExcelData() on controller CI.interview.pltosman.api.Controllers.HomeController (CI.interview.pltosman.api).
2021-09-10 00:00:10.632 +01:00 [INF] Excel data service called.
2021-09-10 00:00:37.920 +01:00 [ERR] Excel data didn't write to database
System.ArgumentException: An item with the same key has already been added. Key: 54d44e4d-d119-4371-8f2d-19525014cbc5
   at System.Collections.Generic.Dictionary`2.TryInsert(TKey key, TValue value, InsertionBehavior behavior)
   at System.Collections.Generic.Dictionary`2.Add(TKey key, TValue value)
   at Microsoft.EntityFrameworkCore.InMemory.Storage.Internal.InMemoryTable`1.Create(IUpdateEntry entry)
   at Microsoft.EntityFrameworkCore.InMemory.Storage.Internal.InMemoryStore.ExecuteTransaction(IList`1 entries, IDiagnosticsLogger`1 updateLogger)
   at Microsoft.EntityFrameworkCore.InMemory.Storage.Internal.InMemoryDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(DbContext _, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.Storage.NonRetryingExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at CI.interview.pltosman.Core.DataAccesss.EntityFramework.EfEntityRepositoryBase`2.Add(TEntity entity) in /Users/osmanpolat/Projects/Interviews/CapitalIndex/CI.interview.pltosman/CI.interview.pltosman.Core/DataAccesss/EntityFramework/EfEntityRepositoryBase.cs:line 101
   at CI.interview.pltosman.Business.Concrete.ExcelDataManager.SaveExcelData(List`1 data) in /Users/osmanpolat/Projects/Interviews/CapitalIndex/CI.interview.pltosman/CI.interview.pltosman.Business/Concrete/ExcelDataManager.cs:line 45
2021-09-10 00:07:41.372 +01:00 [INF] Host starting.
2021-09-10 00:07:42.636 +01:00 [ERR] An error occured during migration
Autofac.Core.Registration.ComponentNotRegisteredException: The requested service 'CI.interview.pltosman.DataAccess.Concrete.EntityFramework.Contexts.InterviewContext' has not been registered. To avoid this exception, either register a component to provide the service, check for service registration using IsRegistered(), or use the ResolveOptional() method to resolve an optional dependency.
   at Autofac.ResolutionExtensions.ResolveService(IComponentContext context, Service service, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType)
   at Autofac.Extensions.DependencyInjection.AutofacServiceProvider.GetRequiredService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CI.interview.pltosman.api.Program.Main(String[] args) in /Users/osmanpolat/Projects/Interviews/CapitalIndex/CI.interview.pltosman/CI.interview.pltosman.api/Program.cs:line 49
2021-09-10 00:07:42.969 +01:00 [INF] Now listening on: http://localhost:5003
2021-09-10 00:07:42.970 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2021-09-10 00:07:42.970 +01:00 [INF] Hosting environment: Development
2021-09-10 00:07:42.970 +01:00 [INF] Content root path: /Users/osmanpolat/Projects/Interviews/CapitalIndex/CI.interview.pltosman/CI.interview.pltosman.api
2021-09-10 00:07:52.689 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5003/api/Home/readExcelData - 0
2021-09-10 00:07:52.744 +01:00 [INF] CORS policy execution failed.
2021-09-10 00:07:52.746 +01:00 [INF] Request origin http://localhost:5003 does not have permission to access the resource.
2021-09-10 00:07:52.748 +01:00 [INF] Executing endpoint 'CI.interview.pltosman.api.Controllers.HomeController.ReadExcelData (CI.interview.pltosman.api)'
2021-09-10 00:07:52.765 +01:00 [INF] Route matched with {action = "ReadExcelData", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult ReadExcelData() on controller CI.interview.pltosman.api.Controllers.HomeController (CI.interview.pltosman.api).
2021-09-10 00:07:52.931 +01:00 [INF] Excel data service called.
2021-09-10 00:10:40.459 +01:00 [INF] Host starting.
2021-09-10 00:10:41.632 +01:00 [ERR] An error occured during migration
Autofac.Core.Registration.ComponentNotRegisteredException: The requested service 'CI.interview.pltosman.DataAccess.Concrete.EntityFramework.Contexts.InterviewContext' has not been registered. To avoid this exception, either register a component to provide the service, check for service registration using IsRegistered(), or use the ResolveOptional() method to resolve an optional dependency.
   at Autofac.ResolutionExtensions.ResolveService(IComponentContext context, Service service, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType)
   at Autofac.Extensions.DependencyInjection.AutofacServiceProvider.GetRequiredService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at CI.interview.pltosman.api.Program.Main(String[] args) in /Users/osmanpolat/Projects/Interviews/CapitalIndex/CI.interview.pltosman/CI.interview.pltosman.api/Program.cs:line 49
2021-09-10 00:10:41.923 +01:00 [INF] Now listening on: http://localhost:5003
2021-09-10 00:10:41.924 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2021-09-10 00:10:41.925 +01:00 [INF] Hosting environment: Development
2021-09-10 00:10:41.925 +01:00 [INF] Content root path: /Users/osmanpolat/Projects/Interviews/CapitalIndex/CI.interview.pltosman/CI.interview.pltosman.api
2021-09-10 00:10:45.515 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5003/api/Home/readExcelData - 0
2021-09-10 00:10:45.574 +01:00 [INF] CORS policy execution failed.
2021-09-10 00:10:45.577 +01:00 [INF] Request origin http://localhost:5003 does not have permission to access the resource.
2021-09-10 00:10:45.578 +01:00 [INF] Executing endpoint 'CI.interview.pltosman.api.Controllers.HomeController.ReadExcelData (CI.interview.pltosman.api)'
2021-09-10 00:10:45.594 +01:00 [INF] Route matched with {action = "ReadExcelData", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult ReadExcelData() on controller CI.interview.pltosman.api.Controllers.HomeController (CI.interview.pltosman.api).
2021-09-10 00:10:45.718 +01:00 [INF] Excel data service called.
2021-09-10 00:10:55.136 +01:00 [INF] Executing OkObjectResult, writing value of type 'CI.interview.pltosman.Core.Utilities.Results.DataResult`1[[System.Collections.Generic.List`1[[CI.interview.pltosman.Entities.Dtos.DataExcelModelDto, CI.interview.pltosman.Entities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2021-09-10 00:10:55.202 +01:00 [INF] Executed action CI.interview.pltosman.api.Controllers.HomeController.ReadExcelData (CI.interview.pltosman.api) in 9603.6389ms
2021-09-10 00:10:55.205 +01:00 [INF] Executed endpoint 'CI.interview.pltosman.api.Controllers.HomeController.ReadExcelData (CI.interview.pltosman.api)'
2021-09-10 00:10:55.211 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5003/api/Home/readExcelData - 0 - 200 - application/json;+charset=utf-8 9699.8639ms
